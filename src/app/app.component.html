
<div class="content-container">

  <input id="playlist" type="file" accept=".xml" (change)="handleFileInput($event.target.files)">

  <ng-container *ngIf="albums">
    <div class="albums-header flex">
      <div>Artist/Album</div>
      <div class="text-right">Points</div>
    </div>
    <ul class="albums">
      <ng-template ngFor let-album [ngForOf]="albums" let-i="index">
        <li class="transition" (click)="toggleShowAlbumDetails(album)">
          <div class="album-title flex">
            <div>{{ album.artist.name }} - {{ album.name }}</div>
            <div class="text-right">
              <span class="points">
                <ng-container *ngTemplateOutlet="starRatings; context: { ratings: album.starRatings }"></ng-container>
              </span>
            </div>
          </div>
          <div class="album-details" *ngIf="album.showDetails">
            <ng-template ngFor let-disc [ngForOf]="album.tracks" let-d="index">
              <div *ngIf="album.tracks.length > 1">Disc {{ +d + 1 }}</div>
              <div *ngFor="let track of disc | keyvalue" class="flex">
                <div>{{ +track.key + 1 }}. {{ track.value.name }}</div>
                <div class="text-right">
                  <ng-container *ngTemplateOutlet="starRatings; context: { ratings: track.value.starRatings }"></ng-container>
                </div>
              </div>
            </ng-template>
          </div>
        </li>
      </ng-template>
    </ul>

  </ng-container>

  <router-outlet></router-outlet>

</div>

<ng-template
  #starRatings
  let-ratings="ratings"
>
  <ul class="star-ratings">
    <ng-template ngFor let-starRating [ngForOf]="ratings">
      <li>
        <i class="star-rating fa-star far"></i>
        <div class="star-rating-fill" [style.width.%]="starRating">
          <i class="star-rating fa-star fas"></i>
        </div>
      </li>
    </ng-template>
  </ul>
</ng-template>